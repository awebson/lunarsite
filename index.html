<html>
<head>
    <title>Brown LUNAR Lab</title>
    <meta charset="UTF-8">
    <link rel="icon" href="favicon.ico">
    <script src="https://code.jquery.com/jquery-3.5.1.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js" integrity="sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.min.js" integrity="sha384-w1Q4orYjBQndcko6MimVbzY0tgp4pWB4lZ7lr30WKz0vr/aWKhXdBNmNb5D92v7s" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css" integrity="sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ho+j7jyWK8fNQe+A12Hb8AhRq26LrZ/JpcUGGOn+Y7RsweNrtN/tE3MoK7ZeZDyx" crossorigin="anonymous"></script>
    <link href="https://fonts.googleapis.com/css?family=Open+Sans|Roboto" rel="stylesheet">
</head>
<style>
img {
    width: 128px;
    max-width: 100%;
    height: auto;
}
.project {
    position: relative;
    text-align: center;
    background-repeat: no-repeat;
    background-size: cover;
    font-family: 'Roboto';
    font-weight: bold;
    min-height: 12em;
}
.project-title {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    background-color: rgba(0, 0, 0, .5);
    color: white;
    margin: 0;
    padding: 10px;
}
.project-desc {
    position: absolute;
    bottom: 0;
    left: 0;
    width: 100%;
    background-color: rgba(0, 0, 0, .5);
    color: white;
    margin: 0;
    padding: 10px;
}
.person {
    width: 100%;
}
#left {
    margin-top: 100px;
}
</style>
<body>
<div class="container mt-5">
    <div class="row">
        <div class="col-sm-4" id="left">
            <img class="py-3" src="lunarlogo.svg">
            <p class="lead py-3">Language Understanding and Representation</p>
            <a class="text-muted" href="https://brown.edu">Brown University</a>
        </div>
        <div class="col-sm-8">
            <p class="h3">Projects</p>
            <div class="mb-5" id="projects"></div>
            <p class="h3 my-4">Faculty</p>
            <div id="faculty"></div>
            <p class="h3 my-4">Current Students</p>
            <div id="current"></div>
            <p class="h3 my-4">Past Students</p>
            <div id="past"></div>
        </div>
    </div>
</div>
</body>
<script>
function resizeProjects() {
    $('.project').each(function() {
        var width = $(this).width()
        $(this).css('height', width)
    })
}

$.ajax({
    type: 'GET',
    url: 'https://plunarlabcit.services.brown.edu/projects.xml',
    dataType: 'xml',
    success: function(xml) {
        var projects = $(xml).find('project')
        for(i = 0; i < projects.length; i++) {
            var row = Math.floor(i / 2)
            var col = i % 2
            if(col == 0) {
                let html = `<div class="row" id="row-` + row + `"></div>`
                $('#projects').append(html)
            }
            let html = `<a class="col-sm-6 project border" target="_blank" id="proj-` + row + `-` + col + `"></a>`
            $('#row-' + row).append(html)
            var project = $('#proj-' + row + '-' + col)
            var title = $(projects[i]).find('title').text()
            var desc = $(projects[i]).find('description').text()
            var url = $(projects[i]).find('url').text()
            var img = $(projects[i]).find('img').text()
            $(project).append('<p class="project-desc">' + desc + '</p>')
            $(project).append('<p class="project-title">' + title + '</p>')
            $(project).css('background-image', 'url(' + img + ')')
            if(url.length) {
                $(project).attr('href', url)
            }
        }

        resizeProjects()
    }
})

$.ajax({
    type: 'GET',
    'url': 'https://plunarlabcit.services.brown.edu/people.xml',
    dataType: 'xml',
    success: function(xml) {
        var people = $(xml).find('person')
        $(people).each(function(i, person) {
            var name = $(person).find('name').text()
            var status = $(person).find('status').text()
            var desc = $(person).find('description').text()
            var url = $(person).find('url').text()
            var img = $(person).find('img').text()
            var nameHtml = ``;
            var html = ``;
            if(url.length) {
                nameHtml += `<span class="lead"><a href="` + url + `" target="_blank">` + name + `</a></span>`
            } else {
                nameHtml += `<span class="lead">` + name + `</span>`
            }
            if(img.length & desc.length) {
                html += `
                    <div class="person py-2 m-2 row">
                        <div class="col-sm-2">
                            <img class="person-img" src="` + img + `">
                        </div>
                        <div class="col-sm-10">
                            <p class="m-0">
                                ` + nameHtml + `
                                <span class="mx-3">` + status + `</span>
                            </p>
                            <p class="m-0">` + desc + `</p>
                        </div>
                    </div>
                `
            } else {
                html += `
                    <div class="person m-2">
                        `+ nameHtml + `
                        <span class="mx-3">` + status + `</span>
                    </div>
                `
            }
            $('#' + $(person).parent()[0].nodeName).append(html)
        })
    }
})

$(window).on('resize', resizeProjects)
</script>
</html>
